
# README: 使用 Python对伪标签进行半监督学习

## 依赖库

- Python 3.7+
- PyTorch 1.10+
- numpy
- tqdm

安装依赖库：
```bash
pip install torch numpy tqdm
```

---

### 使用方法

a. 确保你有一个标注数据集（用于初始模型训练）和一个未标注数据集（用于生成伪标签）

b. 在`pseudo_labeling.py`中配置你的数据路径和模型参数

c. 模型的训练日志会输出在控制台，最终模型保存在`outputs/`目录下

1. **伪标签生成**
   ```python
   outputs = model(inputs)   #使用模型预测
   probs = F.softmax(outputs, dim=1)  #转换为概率分布
   max_probs, pseudo_label = torch.max(probs, dim=1)  #最大概率及伪标签
   ```
   通过 `softmax` 得到类别概率分布，选择概率最大的类别作为伪标签

2. **高置信度筛选**
   ```python
   mask = max_probs > threshold  #筛选置信度高于阈值的样本
   selected_samples = inputs[mask]
   pseudo_labels = pseudo_label[mask]
   ```
   只保留模型对其预测有足够置信的样本，避免伪标签误差传播

3. **训练模型**
   ```python
   outputs = model(selected_samples)  #用高置信度伪标签样本训练模型
   loss = criterion(outputs, pseudo_labels)
   loss.backward()
   optimizer.step()
   ```
   使用伪标签数据更新模型参数

---

## 例子

你有一个包含10,000张图片的数据集，其中只有2,000张有标签（标注为猫或狗），剩下8,000张未标注
  1. 用标注数据训练初始模型
  2. 用模型预测未标注数据的标签（伪标签）
  3. 只选择预测结果可信度高于90%的样本（例如这张图片99%是猫）
  4. 用这些高置信度的伪标签数据继续训练模型

---


## 总结


| **场景**               | **现状**                                                                 | **未来改进方向**                                                                                     |
|------------------------|------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------|
| **伪标签质量**          | 依赖单一模型生成，可能包含大量错误                                        | 引入多模型协作、软伪标签与抗噪机制                                                                   |
| **低置信度样本利用**     | 仅利用高置信度样本，丢弃大部分低置信度数据                                | 使用一致性正则化和自监督方法挖掘低置信度样本价值                                                     |
| **抗噪与动态性**         | 伪标签更新固定，错误易传播                                              | 动态伪标签更新与抗噪训练方法                                                                         |
| **生成能力与数据增强**    | 依赖判别模型，缺乏生成能力                                              | 融合生成对抗网络（GAN）和扩散模型，扩展伪标签生成能力                                               |
| **领域适应与跨模态**     | 在单一模态或单领域中效果较好                                            | 推广到跨领域迁移和多模态学习                                                                         |
| **理论研究**            | 以实验驱动为主，缺乏数学理论支持                                        | 构建伪标签影响泛化性能和优化过程的理论框架                                                           |

---

## 学习资源

- [论文：Pseudo-Labeling and Self-training](https://arxiv.org/abs/1905.13736)
- [PyTorch官方教程](https://pytorch.org/tutorials/)

---

欢迎反馈问题或建议！ 😊
